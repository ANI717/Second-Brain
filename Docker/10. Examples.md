```dockerfile
# syntax=docker/dockerfile:1.7
FROM python:3.12-slim AS builder
WORKDIR /w
COPY pyproject.toml poetry.lock ./
RUN --mount=type=cache,target=/root/.cache/pip \
    pip install --upgrade pip && pip install poetry \
 && poetry export -f requirements.txt --without-hashes -o req.txt \
 && pip wheel -r req.txt -w /wheels

FROM python:3.12-slim AS runtime
WORKDIR /app
COPY --from=builder /wheels /wheels
RUN pip install --no-cache-dir /wheels/*
COPY src/ /app/src/
ENTRYPOINT ["python", "-m", "src.main"]
```

```dockerfile
# syntax=docker/dockerfile:1.7
FROM node:22-alpine AS deps
WORKDIR /w
COPY package.json package-lock.json ./
RUN --mount=type=cache,target=/root/.npm npm ci

FROM node:22-alpine AS build
WORKDIR /w
COPY --from=deps /w/node_modules /w/node_modules
COPY . .
RUN npm run build

FROM node:22-alpine AS runtime
WORKDIR /app
ENV NODE_ENV=production
COPY --from=deps /w/node_modules /app/node_modules
COPY --from=build /w/dist /app/dist
CMD ["node", "dist/server.js"]
```

```dockerfile
FROM golang:1.23 AS build
WORKDIR /src
COPY go.mod go.sum ./
RUN go mod download
COPY . .
RUN CGO_ENABLED=0 go build -o /bin/app ./cmd/app

FROM gcr.io/distroless/base-debian12
COPY --from=build /bin/app /app
USER 65532:65532
ENTRYPOINT ["/app"]
```
